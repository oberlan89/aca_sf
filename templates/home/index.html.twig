{% extends 'content_base.html.twig' %}

{% block content_title %}ACA{% endblock %}

{% block content_body %}
    <h2 class="h5 mb-3">Inicio</h2>

    <p class="mb-2">
        Accesó como <strong>{{ app.user.email }}</strong>
    </p>

    <p class="mb-3">
        Buscar: <strong>{{ q ?? '—' }}</strong><br>
        Total de unidades encontradas: <strong>{{ pager.nbResults }}</strong>
    </p>

    {% if assignments is not null %}
        <h3 class="h6 mt-4">Mis asignaciones</h3>

        <table class="table table-sm table-striped">
            <thead>
            <tr>
                <th>Codigo</th>
                <th>Unidad</th>
                <th>Asignación</th>
                <th>Alcance</th>
            </tr>
            </thead>
            <tbody>
            {% for ua in assignments %}
                <tr>
                    <td>{{ ua.unit.code }}</td>
                    <td>{{ ua.unit.name }}</td>
                    <td>{{ ua.assignment.value }}</td>
                    <td>{{ ua.scope }}</td>
                </tr>
            {% else %}
                <tr><td colspan="4" class="text-muted">No assignments.</td></tr>
            {% endfor %}
            </tbody>
        </table>
    {% endif %}

    <h3 class="h6 mt-4">Unidades</h3>

    <table class="table table-sm table-hover">
        <thead>
        <tr>
            <th>Codigo</th>
            <th>Unidad</th>
            <th>Equipo</th>
            <th>Subfondo</th>
        </tr>
        </thead>
        <tbody>
        {% for u in pager %}
            <tr>
                <td>{{ u.code }}</td>
                <td>{{ u.name }}</td>
                <td>{{ u.team ? u.team.number : '' }}</td>
                <td>{{ u.subfondo ? u.subfondo.name : '' }}</td>
            </tr>
        {% else %}
            <tr>
                <td colspan="4" class="text-muted">No results.</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    {# Keep q in the URL when going to page 2 #}
    {{ pagerfanta(pager, null, {
        routeName: 'app_home',
        routeParams: q ? { q: q } : {}
    }) }}
{% endblock %}
